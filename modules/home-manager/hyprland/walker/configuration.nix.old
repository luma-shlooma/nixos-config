# This was made in reference to the main branch, not the version available on nixpkgs
{ pkgs, ... }:

{
  services.walker = {
    enable = true;
    systemd.enable = true;
    package = pkgs.walker;
    settings = {
      # General
      force_keyboard_focus = false;    # forces keyboard forcus to stay in Walker
      close_when_open = true;          # close walker when invoking while already opened
      selection_wrap = false;          # wrap list if at bottom or top
      global_argument_delimiter = "#"; # query: firefox#https://benz.dev => part after delimiter will be ignored when querying. this should be the same as in the elephant config
      keep_open_modifier = "shift";    # won't close on activation, but rather select the next item in the list
      exact_search_prefix = "'";       # disable fuzzy searching
      theme = "default";               # theme to use
      disable_mouse = false;           # disable mouse (on input and list only)
      # ???
      shell = {
        anchor_top = true;
        anchor_bottom = true;
        anchor_left = true;
        anchor_right = true;
      };
      # Placeholders for input and empty list, key is the providers name, so f.e. "desktopapplications" or "menus:other"
      placeholders = {
        "default" = {
          input = "Search";
          list = "No Results";
        };
      };
      # General keybinds
      keybinds = {
        close = "Escape";
        next = "Tab";
        previous = "Up";
        toggle_exact = "";
        resume_last_query = "";
        quick_activate = [];
      };
      # Providers are modes or types of selection options
      providers = {
        # Providers to be queried by default
        default = ["desktopapplications"];
        # Providers to be queried when query is empty
        empty = ["desktopapplications"];
        # Prefixes to specify certain modes
        prefixes = [
          {
            prefix = ";";
            provider = "providerlist";
          }
          {
            prefix = "/";
            provider = "files";
          }
          {
            prefix = "$";
            provider = "runner";
          }
          {
            prefix = ".";
            provider = "symbols";
          }
          {
            prefix = "!";
            provider = "todo";
          }
          {
            prefix = "=";
            provider = "calc";
          }
          {
            prefix = "@";
            provider = "websearch";
          }
          {
            prefix = ":";
            provider = "clipboard";
          }
        ];
        # Specific providers
        "calc" = {
          default = "copy";
          copy = "Return";
          save = "ctrl s";
          delete = "ctrl d";
        };
        "websearch" = {
          default = "search";
          search = "Return";
          remove_history = "ctrl BackSpace";
        };
        "providerlist" = {
          default = "activate";
          activate = "Return";
        };
        "clipboard" = {
          time_format = "%d.%m. - %H:%M"; # format for the clipboard item date
          default = "copy";
          copy = "Return";
          delete = "ctrl d";
          edit = "ctrl o";
          toggle_images_only = "ctrl i";
        };
        "desktopapplications" = {
          default = "start";
          start = "Return";
          start_keep_open = "shift Return";
          remove_history = "ctrl BackSpace";
          toggle_pin = "ctrl p";
        };
        "files" = {
          default = "open";
          open = "Return";
          open_dir = "ctrl Return";
          copy_path = "ctrl shift c";
          copy_file = "ctrl c";
        };
        "todo" = {
          default = "save";
          save = "Return";
          delete = "ctrl d";
          mark_active = "ctrl a";
          mark_done = "ctrl f";
          clear = "ctrl x";
        };
        "runner" = {
          default = "start";
          start = "Return";
          start_terminal = "shift Return";
          remove_history = "ctrl BackSpace";
        };
        "dmenu" = {
          default = "select";
          select = "Return";
        };
        "symbols" = {
          default = "copy";
          copy = "Return";
          remove_history = "ctrl BackSpace";
        };
        "unicode" = {
          default = "copy";
          copy = "Return";
          remove_history = "ctrl BackSpace";
        };
        "menus" = {
          default = "activate";
          activate = "Return";
          remove_history = "ctrl BackSpace";
        };
      };

    };
  };
}
